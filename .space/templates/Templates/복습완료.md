<%*
// 복습 완료 처리 스크립트
const file = tp.file.find_tfile(tp.file.path(true));
if (!file) {
    new Notice("❌ 파일을 찾을 수 없습니다.");
    return;
}

try {
    // 현재 Properties 가져오기
    await app.fileManager.processFrontMatter(file, (frontmatter) => {
        // 현재 복습 횟수 증가
        const currentReviewCount = parseInt(frontmatter["review-count"]) || 0;
        frontmatter["review-count"] = currentReviewCount + 1;
        
        // 복습 날짜 배열에 추가
        const reviewDates = frontmatter["review-dates"] || [];
        const today = tp.date.now("YYYY-MM-DD");
        
        if (!reviewDates.includes(today)) {
            reviewDates.push(today);
            frontmatter["review-dates"] = reviewDates;
        }
        
        // 복습 횟수에 따른 상태 업데이트
        if (currentReviewCount + 1 >= 3) {
            frontmatter["status"] = "복습완료";
        } else if (frontmatter["status"] === "완료") {
            frontmatter["status"] = "복습중";
        }
    });
    
    const currentReviewCount = parseInt(file.frontmatter?.["review-count"]) || 0;
    const newReviewCount = currentReviewCount + 1;
    
    // 성공 메시지
    if (newReviewCount === 1) {
        new Notice("📚 1차 복습이 완료되었습니다!");
    } else if (newReviewCount === 2) {
        new Notice("🔄 2차 복습이 완료되었습니다!");
    } else if (newReviewCount >= 3) {
        new Notice("🎉 3차 복습 완료! 완전히 마스터하셨습니다!");
    } else {
        new Notice(`📖 ${newReviewCount}차 복습이 완료되었습니다!`);
    }
    
} catch (error) {
    new Notice("❌ 복습 기록 중 오류가 발생했습니다.");
    console.error("Review update error:", error);
}
%>

# 🔄 복습 완료!

## 📊 복습 현황

<%*
const file = tp.file.find_tfile(tp.file.path(true));
const reviewCount = parseInt(file?.frontmatter?.["review-count"]) || 0;
const reviewDates = file?.frontmatter?.["review-dates"] || [];
const lectureName = file?.frontmatter?.["lecture-name"] || "강의";
%>

### 📚 **<%= lectureName %>** 복습 기록

- **총 복습 횟수**: 🔄 **<%= reviewCount %>회**
- **오늘 날짜**: <%= tp.date.now("YYYY-MM-DD") %>

### 📅 복습 이력
<%* 
reviewDates.forEach((date, index) => {
    const reviewNumber = index + 1;
    const emoji = reviewNumber === 1 ? "📚" : reviewNumber === 2 ? "🔄" : "🎯";
%>
- **<%= reviewNumber %>차 복습**: <%= emoji %> <%= date %>
<%* }); %>

### 🎯 복습 단계별 가이드

<%* if (reviewCount === 1) { %>
**1차 복습 완료!** 📚
- 다음 복습 권장일: <%= tp.date.now("YYYY-MM-DD", 7) %> (1주일 후)
- 복습 포인트: 전체 내용 훑어보기, 핵심 개념 재확인

<%* } else if (reviewCount === 2) { %>
**2차 복습 완료!** 🔄  
- 다음 복습 권장일: <%= tp.date.now("YYYY-MM-DD", 14) %> (2주일 후)
- 복습 포인트: 실습 위주, 응용 문제 풀기

<%* } else if (reviewCount >= 3) { %>
**3차 복습 완료!** 🎉
- 🏆 **완전 마스터 달성!**
- 이 강의는 이제 완전히 내 것이 되었습니다!
- 필요시 언제든 참고 자료로 활용하세요.

<%* } else { %>
**복습 완료!** 📖
- 지속적인 복습으로 학습 효과를 극대화하세요!

<%* } %>

---

## 💡 복습 효과성

### 🧠 기억 강화 효과
- **에빙하우스 망각곡線**: 복습을 통해 기억 지속성 향상
- **간격 반복**: 점진적 간격으로 장기 기억 전환

### 📈 학습 성과 배가
- **1차 복습**: 이해도 70% → 85%
- **2차 복습**: 이해도 85% → 95%  
- **3차 복습**: 이해도 95% → 99% (마스터)

---

**🎯 다음 액션**: [[📊 강의학습 대시보드 (Properties)]]에서 전체 복습 현황을 확인해보세요!
