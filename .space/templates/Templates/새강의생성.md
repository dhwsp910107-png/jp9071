<%*
// 빠른 강의 생성 스크립트
const lectureName = await tp.system.prompt("강의명을 입력하세요:");
if (!lectureName) {
    new Notice("❌ 강의명이 입력되지 않았습니다.");
    return;
}

const instructor = await tp.system.prompt("강사명을 입력하세요:");
const totalMinutes = parseInt(await tp.system.prompt("강의 총 시간(분)을 입력하세요:"));
const series = await tp.system.prompt("강의 시리즈명을 입력하세요:");
const courseNumber = await tp.system.prompt("강의 번호를 입력하세요:");
const totalCourses = await tp.system.prompt("전체 강의 수를 입력하세요:");

if (!totalMinutes || isNaN(totalMinutes)) {
    new Notice("❌ 올바른 시간을 입력해주세요.");
    return;
}

const segments = Math.ceil(totalMinutes / 10);
const today = tp.date.now("YYYY-MM-DD");
const fileName = `${today} ${lectureName} 강의학습`;

// 템플릿 내용 생성
let template = `# 🎬 강의 학습 템플릿
## 📋 기본 정보
- **강의명**: ${lectureName}
- **강사**: ${instructor || "미입력"}
- **학습 날짜**: ${today}
- **강의 시간**: ${totalMinutes}분
- **예상 진행 시간**: ${totalMinutes}분
---
## 📊 전체 진행률
**진행 상황**: \`VIEW[{완료구간}/{총구간}구간 완료 ({(완료구간/총구간*100).toFixed(1)}%)][text]\`
**진행바**: \`VIEW[repeat("▓", 완료구간) + repeat("░", 총구간-완료구간)][text]\`

totalminutes:: ${totalMinutes}
segments:: ${segments}
lecture-series:: ${series || "일반"}
course-number:: ${courseNumber || "1"}
total-courses:: ${totalCourses || "1"}
instructor:: ${instructor || "미입력"}
completed-segments:: 0
status:: 미시작
---
## ⏱️ 10분 단위 세부 진행
`;

// 구간별 섹션 생성
for(let i = 1; i <= segments; i++) {
    const startTime = (i-1) * 10;
    const endTime = Math.min(i * 10, totalMinutes);
    
    template += `### 📍 ${i}구간 (${startTime}-${endTime}분)
- [ ] **학습 완료** ✅ #강의학습 
- **주요 내용**:
  \`\`\`
  {{이 구간에서 학습한 핵심 내용을 정리하세요}}
  \`\`\`
- **메모**:
  \`\`\`
  {{추가 메모나 중요 포인트}}
  \`\`\`
- **이해도**: ⭐⭐⭐⭐⭐ (5점 만점)
---
`;
}

template += `## 📝 전체 정리
### 🎯 핵심 요약
\`\`\`
{{강의 전체의 핵심 내용을 요약하세요}}
\`\`\`
### 💡 새로 배운 내용
\`\`\`
{{이번 강의에서 새롭게 알게 된 내용}}
\`\`\`
### ❓ 질문/의문점
\`\`\`
{{학습 중 생긴 질문이나 의문점을 기록하세요}}
\`\`\`
### 🔄 복습 필요 사항
\`\`\`
{{다시 복습이 필요한 부분이나 어려웠던 내용을 기록하세요}}
\`\`\`
---
## 🔗 실습 및 과제
### 💻 실습 내용
- [ ] **실습 1**: {{실습내용1}}
- [ ] **실습 2**: {{실습내용2}}
- [ ] **실습 3**: {{실습내용3}}
### 📚 과제/숙제
- [ ] **과제 1**: {{과제내용1}} (마감: {{마감일1}})
- [ ] **과제 2**: {{과제내용2}} (마감: {{마감일2}})
---
## 📈 학습 현황
### ⏱️ 시간 기록
- **시작 시간**: {{시작시간}}
- **완료 시간**: {{완료시간}}
- **실제 소요 시간**: {{실제소요시간}}
- **일시정지 횟수**: {{일시정지횟수}}회
- **집중도**: ⭐⭐⭐⭐⭐ (5점 만점)
### 🎯 전체 평가
- **내용 난이도**: ⭐⭐⭐⭐⭐ (5점 만점)
- **강의 만족도**: ⭐⭐⭐⭐⭐ (5점 만점)
- **전체 이해도**: ⭐⭐⭐⭐⭐ (5점 만점)
- **추천 여부**: {{추천여부}} (예/아니오)
### 📊 진도 상황
- **전체 진행률**: \`VIEW[완료구간][text]\`/\`VIEW[총구간][text]\` (\`VIEW[(완료구간/총구간*100).toFixed(1)][text]\`%)
- **이전 강의**: [[이전강의명]]
- **다음 강의**: [[다음강의명]]
---
## 🔗 관련 링크 및 자료
### 🌐 강의 링크
- **강의 URL**: {{강의URL}}
- **강의 자료**: [[{{강의자료파일명}}]]
- **실습 파일**: [[{{실습파일명}}]]
### 📚 참고 자료
- **교재 페이지**: {{교재페이지}}
- **추가 자료**: [[{{추가자료1}}]], [[{{추가자료2}}]]
- **관련 강의**: [[{{관련강의명}}]]
---
## 🏷️ 메타데이터
- **생성일**: \`=date(now)\`
- **태그**: #강의학습 #${series?.replace(/\s+/g, '') || '일반'} #진도관리
- **카테고리**: 온라인강의
- **시리즈**: ${series || "일반"} - ${courseNumber || "1"}/${totalCourses || "1"}
`;

// 파일 생성
const newFile = await tp.file.create_new(template, fileName, false, "강의학습");

new Notice(`✅ "${lectureName}" 강의가 생성되었습니다!`);

// 새 파일 열기
app.workspace.openLinkText(newFile.path, '', true);
%>

🎉 **새 강의가 성공적으로 생성되었습니다!**

- 강의명: <%= lectureName %>
- 총 시간: <%= totalMinutes %>분
- 구간 수: <%= segments %>개
- 파일 위치: 강의학습/<%= fileName %>.md

[[📊 강의학습 대시보드]]에서 전체 진행 현황을 확인할 수 있습니다.
