<%*
// 체크박스 토글 시 자동 진도 업데이트 스크립트
const file = tp.file.find_tfile(tp.file.path(true));
if (!file) return;

// 현재 파일 내용 읽기
let content = await app.vault.read(file);

// 완료된 구간 수 계산
const completedSegments = (content.match(/- \[x\] \*\*학습 완료\*\* ✅ #강의학습/g) || []).length;
const totalSegments = (content.match(/- \[.\] \*\*학습 완료\*\* ✅ #강의학습/g) || []).length;

// 진행률 계산
const progressPercent = totalSegments > 0 ? Math.round((completedSegments / totalSegments) * 100) : 0;

// 상태 결정
let status = "미시작";
if (completedSegments === totalSegments && totalSegments > 0) {
    status = "완료";
} else if (completedSegments > 0) {
    status = "진행중";
}

// 메타데이터 업데이트
content = content.replace(/completed-segments::\s*\d+/, `completed-segments:: ${completedSegments}`);
content = content.replace(/status::\s*\S+/, `status:: ${status}`);

// 파일 업데이트
await app.vault.modify(file, content);

// 알림 표시
if (completedSegments === totalSegments && totalSegments > 0) {
    new Notice("🎉 축하합니다! 강의 학습이 완료되었습니다!");
} else {
    new Notice(`📚 진도 업데이트: ${completedSegments}/${totalSegments} 구간 완료 (${progressPercent}%)`);
}
%>

✅ **진도가 자동으로 업데이트되었습니다!**

- 완료 구간: <%= completedSegments %>/<%= totalSegments %>
- 진행률: <%= progressPercent %>%
- 상태: <%= status %>
