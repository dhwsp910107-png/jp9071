# ğŸ¬ ê°•ì˜ í•™ìŠµ í…œí”Œë¦¿ (ê³ ê¸‰ ì§„í–‰ë¥  ì‹œìŠ¤í…œ)
<%*
const lectureName = await tp.system.prompt("ê°•ì˜ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:");
const instructor = await tp.system.prompt("ê°•ì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:");
const totalMinutes = parseInt(await tp.system.prompt("ê°•ì˜ ì´ ì‹œê°„(ë¶„)ì„ ì…ë ¥í•˜ì„¸ìš”:"));
const customSegments = await tp.system.prompt("êµ¬ê°„ ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ê¸°ë³¸ê°’: ìë™ê³„ì‚°, ì§ì ‘ ì…ë ¥ ì›í•˜ë©´ ìˆ«ì ì…ë ¥):");
const series = await tp.system.prompt("ê°•ì˜ ì‹œë¦¬ì¦ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”:");
const courseNumber = await tp.system.prompt("ê°•ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
const totalCourses = await tp.system.prompt("ì „ì²´ ê°•ì˜ ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");

if (!totalMinutes || isNaN(totalMinutes)) {
    throw new Error("ì˜¬ë°”ë¥¸ ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
}

// êµ¬ê°„ ìˆ˜ ê²°ì •
let segments;
if (customSegments && !isNaN(customSegments) && parseInt(customSegments) > 0) {
    segments = parseInt(customSegments);
    tR += `\nâœ… ì‚¬ìš©ì ì„¤ì •: ${segments}ê°œ êµ¬ê°„ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.`;
} else {
    segments = Math.ceil(totalMinutes / 10);
    tR += `\nğŸ”„ ìë™ ê³„ì‚°: ${totalMinutes}ë¶„ â†’ ${segments}ê°œ êµ¬ê°„ (10ë¶„ë‹¹ 1êµ¬ê°„)`;
}

const today = tp.date.now("YYYY-MM-DD");
%>---
lecture-name: "<%= lectureName %>"
instructor: "<%= instructor || 'ë¯¸ì…ë ¥' %>"
lecture-date: "<%= today %>"
total-minutes: <%= totalMinutes %>
segments: <%= segments %>
lecture-series: "<%= series || 'ì¼ë°˜' %>"
course-number: <%= courseNumber || 1 %>
total-courses: <%= totalCourses || 1 %>
completed-segments: 0
status: "ë¯¸ì‹œì‘"
difficulty: ""
satisfaction: ""
understanding: ""
recommend: ""
review-count: 0
review-dates: []
study-start-time: ""
study-end-time: ""
actual-time: ""
concentration: ""
completion-threshold: 80
auto-complete-enabled: true
tags:
  - ê°•ì˜í•™ìŠµ
  - <%= (series || 'ì¼ë°˜').replace(/\s+/g, '') %>
  - ì§„ë„ê´€ë¦¬
category: "ì˜¨ë¼ì¸ê°•ì˜"
created: <%= tp.date.now("YYYY-MM-DD") %>
---

## ğŸ“‹ ê¸°ë³¸ ì •ë³´
- **ê°•ì˜ëª…**: <%= lectureName %>
- **ê°•ì‚¬**: <%= instructor || 'ë¯¸ì…ë ¥' %>
- **í•™ìŠµ ë‚ ì§œ**: <%= today %>
- **ê°•ì˜ ì‹œê°„**: <%= totalMinutes %>ë¶„
- **ì˜ˆìƒ ì§„í–‰ ì‹œê°„**: <%= totalMinutes %>ë¶„

---

## ğŸ“Š ì‹¤ì‹œê°„ ì§„í–‰ë¥  ëŒ€ì‹œë³´ë“œ

```dataviewjs
// í˜„ì¬ í˜ì´ì§€ì˜ í•™ìŠµ ì§„í–‰ë¥  ìë™ ê³„ì‚°
const tasks = dv.current().file.tasks;
const lectureCompletionTasks = tasks.where(t => t.text.includes("í•™ìŠµ ì™„ë£Œ") && t.text.includes("#ê°•ì˜í•™ìŠµ"));
const total = lectureCompletionTasks.length;
const done = lectureCompletionTasks.where(t => t.completed).length;
const percentage = total > 0 ? Math.round((done / total) * 100) : 0;

// ì „ì²´ ë³µìŠµ ë¼ìš´ë“œ ê³„ì‚° (ê° êµ¬ê°„ì˜ ë³µìŠµ ì™„ë£Œ ê°œìˆ˜)
const content = await dv.io.load(dv.current().file.path);

// ê° ì°¨ìˆ˜ë³„ ì „ì²´ êµ¬ê°„ì—ì„œ ì™„ë£Œëœ ê°œìˆ˜ ê³„ì‚°
const round1Matches = content.match(/- \[x\] 1ì°¨ ë³µìŠµ ğŸ”„/g) || [];
const round2Matches = content.match(/- \[x\] 2ì°¨ ë³µìŠµ ğŸ”„/g) || [];
const round3Matches = content.match(/- \[x\] 3ì°¨ ë³µìŠµ ğŸ”„/g) || [];
const round4Matches = content.match(/- \[x\] 4ì°¨ ë³µìŠµ ğŸ”„/g) || [];
const round5Matches = content.match(/- \[x\] 5ì°¨ ë³µìŠµ ğŸ”„/g) || [];

const reviewRounds = [
    { round: 1, completed: round1Matches.length, total: total },
    { round: 2, completed: round2Matches.length, total: total },
    { round: 3, completed: round3Matches.length, total: total },
    { round: 4, completed: round4Matches.length, total: total },
    { round: 5, completed: round5Matches.length, total: total }
];

// ì™„ë£Œëœ ì „ì²´ ë³µìŠµ ë¼ìš´ë“œ ê³„ì‚°
let completedFullRounds = 0;
for (const round of reviewRounds) {
    if (round.completed === round.total && round.total > 0) {
        completedFullRounds++;
    } else {
        break; // ì™„ë£Œë˜ì§€ ì•Šì€ ë¼ìš´ë“œê°€ ë‚˜ì˜¤ë©´ ì¤‘ë‹¨
    }
}

// í˜„ì¬ ì§„í–‰ì¤‘ì¸ ë¼ìš´ë“œ
let currentRound = completedFullRounds + 1;
let currentRoundProgress = 0;
if (currentRound <= 5) {
    currentRoundProgress = reviewRounds[currentRound - 1].completed;
}

// ì „ì²´ ê°œë³„ ë³µìŠµ ì™„ë£Œ ê°œìˆ˜ (ëª¨ë“  ì²´í¬ëœ ë³µìŠµ)
const totalIndividualReviews = round1Matches.length + round2Matches.length + round3Matches.length + round4Matches.length + round5Matches.length;

// ì™„ë£Œ ì„ê³„ì  ì²´í¬
const threshold = dv.current()["completion-threshold"] || 80;
const isLectureComplete = percentage >= threshold;

// ì§„í–‰ë°” ìƒì„±
const progressBar = "â–“".repeat(Math.floor(percentage/10)) + "â–‘".repeat(10-Math.floor(percentage/10));
const reviewBar = "ğŸ”„".repeat(Math.min(completedFullRounds, 5)) + "â—‹".repeat(Math.max(0, 5 - completedFullRounds));

// ê²°ê³¼ ì¶œë ¥
dv.paragraph(`### ğŸ¯ ê°•ì˜ ì§„í–‰ í˜„í™©`);
dv.paragraph(`**ì´ ${total}ê°œ êµ¬ê°„ ì¤‘ ${done}ê°œ ì™„ë£Œ (${percentage}%)**`);
dv.paragraph(`**ì§„í–‰ë°”**: ${progressBar}`);
dv.paragraph(`<progress value="${done}" max="${total}" style="width: 100%; height: 25px; background: linear-gradient(90deg, #6366f1, #8b5cf6);"></progress>`);

dv.paragraph(`### ğŸ”„ ë³µìŠµ í˜„í™©`);
dv.paragraph(`**ì™„ë£Œëœ ì „ì²´ ë³µìŠµ**: ${completedFullRounds}íšŒ`);
dv.paragraph(`**ì „ì²´ ë³µìŠµ ë°”**: ${reviewBar}`);
dv.paragraph(`<progress value="${completedFullRounds}" max="5" style="width: 100%; height: 30px; background: linear-gradient(90deg, #f59e0b, #fbbf24);"></progress>`);
dv.paragraph(`**í˜„ì¬ ${currentRound}ì°¨ ë³µìŠµ ì§„í–‰**: ${currentRoundProgress}/${total} êµ¬ê°„`);
const currentRoundBar = "â–“".repeat(Math.floor((currentRoundProgress/total)*10)) + "â–‘".repeat(10-Math.floor((currentRoundProgress/total)*10));
dv.paragraph(`**í˜„ì¬ ë¼ìš´ë“œ ë°”**: ${currentRoundBar}`);
dv.paragraph(`<progress value="${currentRoundProgress}" max="${total}" style="width: 100%; height: 20px; background: linear-gradient(90deg, #10b981, #34d399);"></progress>`);
dv.paragraph(`**ì´ ê°œë³„ ë³µìŠµ**: ${totalIndividualReviews}íšŒ`);

// ë³µìŠµ ë¼ìš´ë“œë³„ ìƒì„¸ ì •ë³´
dv.paragraph(`### ğŸ“ˆ ë³µìŠµ ë¼ìš´ë“œ ìƒì„¸`);
for (const round of reviewRounds) {
    const roundPercentage = round.total > 0 ? Math.round((round.completed / round.total) * 100) : 0;
    const status = round.completed === round.total && round.total > 0 ? "âœ…" : round.completed > 0 ? "ğŸ”„" : "â­•";
    dv.paragraph(`**${round.round}ì°¨**: ${status} ${round.completed}/${round.total} (${roundPercentage}%)`);
}

// ì™„ë£Œ ìƒíƒœ ì²´í¬
if (isLectureComplete) {
    dv.paragraph(`### ğŸ‰ ê°•ì˜ ì™„ë£Œ!`);
    dv.paragraph(`**ì¶•í•˜í•©ë‹ˆë‹¤! ${threshold}% ì´ìƒ ì™„ë£Œí•˜ì—¬ ê°•ì˜ê°€ ì™„ë£Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.**`);
    
    // ìë™ ì™„ë£Œ ì²˜ë¦¬ (Properties ì—…ë°ì´íŠ¸)
    if (dv.current()["auto-complete-enabled"]) {
        dv.paragraph(`**âœ… ìë™ ì™„ë£Œ ì²˜ë¦¬ê°€ í™œì„±í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.**`);
    }
} else {
    const remaining = threshold - percentage;
    dv.paragraph(`### ğŸ¯ ì™„ë£Œê¹Œì§€`);
    dv.paragraph(`**${remaining}% ë” ì§„í–‰í•˜ë©´ ê°•ì˜ ì™„ë£Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.**`);
}

// ì „ì²´ ì‹œë¦¬ì¦ˆ ì§„í–‰ë¥ ì— ê¸°ì—¬ë„ ê³„ì‚°
const seriesContribution = isLectureComplete ? 100 : percentage;
dv.paragraph(`### ğŸ“Š ì‹œë¦¬ì¦ˆ ê¸°ì—¬ë„`);
dv.paragraph(`**ì´ ê°•ì˜ì˜ ì‹œë¦¬ì¦ˆ ê¸°ì—¬ë„: ${seriesContribution}%**`);
```

---

## â±ï¸ 10ë¶„ ë‹¨ìœ„ ì„¸ë¶€ ì§„í–‰
<%* for(let i = 1; i <= segments; i++) { %>
### ğŸ“ <%= i %>êµ¬ê°„ (<%= (i-1)*10 %>-<%= Math.min(i*10, totalMinutes) %>ë¶„)
- [ ] **í•™ìŠµ ì™„ë£Œ** âœ… #ê°•ì˜í•™ìŠµ 
- **ì£¼ìš” ë‚´ìš©**:
  ```
  {{ì´ êµ¬ê°„ì—ì„œ í•™ìŠµí•œ í•µì‹¬ ë‚´ìš©ì„ ì •ë¦¬í•˜ì„¸ìš”}}
  ```
- **ë©”ëª¨**:
  ```
  {{ì¶”ê°€ ë©”ëª¨ë‚˜ ì¤‘ìš” í¬ì¸íŠ¸}}
  ```
- **ë³µìŠµ ì²´í¬**: 
  - [ ] 1ì°¨ ë³µìŠµ ğŸ”„
  - [ ] 2ì°¨ ë³µìŠµ ğŸ”„
  - [ ] 3ì°¨ ë³µìŠµ ğŸ”„
  - [ ] 4ì°¨ ë³µìŠµ ğŸ”„
  - [ ] 5ì°¨ ë³µìŠµ ğŸ”„
- **ë³µìŠµ í•„ìš”**: [ ] (ì–´ë ¤ìš´ ë¶€ë¶„ì´ë©´ ì²´í¬)
---
<%* } %>

## ğŸ† ì™„ë£Œ ì¡°ê±´ ì„¤ì •

### âš™ï¸ ìë™ ì™„ë£Œ ì„¤ì •
- **ì™„ë£Œ ì„ê³„ì **: `= this.completion-threshold + "%"` (ê¸°ë³¸: 80%)
- **ìë™ ì™„ë£Œ**: `= this.auto-complete-enabled ? "í™œì„±í™”" : "ë¹„í™œì„±í™”"`

> ğŸ’¡ **ì„¤ëª…**: ì²´í¬ë°•ìŠ¤ ì™„ë£Œìœ¨ì´ ì„ê³„ì ì„ ë„˜ìœ¼ë©´ ìë™ìœ¼ë¡œ ê°•ì˜ê°€ "ì™„ë£Œ" ìƒíƒœë¡œ ë³€ê²½ë©ë‹ˆë‹¤.

### ğŸ“Š ì‹œë¦¬ì¦ˆ ì „ì²´ ì§„í–‰ë¥  ê¸°ì—¬

```dataviewjs
// ê°™ì€ ì‹œë¦¬ì¦ˆì˜ ë‹¤ë¥¸ ê°•ì˜ë“¤ê³¼ ë¹„êµ
const currentSeries = dv.current()["lecture-series"];
const seriesLectures = dv.pages('#ê°•ì˜í•™ìŠµ')
    .where(p => p["lecture-series"] === currentSeries)
    .array();

if (seriesLectures.length > 1) {
    dv.paragraph(`### ğŸ¬ ${currentSeries} ì‹œë¦¬ì¦ˆ ì „ì²´ í˜„í™©`);
    
    let totalSeriesProgress = 0;
    const lectureProgress = [];
    
    for (const lecture of seriesLectures) {
        const lectureFile = dv.page(lecture.file.path);
        if (lectureFile) {
            // ê° ê°•ì˜ì˜ ì™„ë£Œìœ¨ ê³„ì‚°
            const tasks = lectureFile.file.tasks;
            const lectureTasks = tasks.where(t => t.text.includes("í•™ìŠµ ì™„ë£Œ") && t.text.includes("#ê°•ì˜í•™ìŠµ"));
            const total = lectureTasks.length;
            const done = lectureTasks.where(t => t.completed).length;
            const percentage = total > 0 ? Math.round((done / total) * 100) : 0;
            
            // ì„ê³„ì  ë„˜ìœ¼ë©´ 100%ë¡œ ê³„ì‚°, ì•„ë‹ˆë©´ ì‹¤ì œ ì§„í–‰ë¥ 
            const threshold = lectureFile["completion-threshold"] || 80;
            const contribution = percentage >= threshold ? 100 : percentage;
            
            totalSeriesProgress += contribution;
            
            lectureProgress.push([
                `[[${lecture.file.name}|${lecture["lecture-name"] || "ê°•ì˜ " + lecture["course-number"]}]]`,
                `${percentage}%`,
                percentage >= threshold ? "âœ… ì™„ë£Œ" : "ğŸ”„ ì§„í–‰ì¤‘",
                `${contribution}% ê¸°ì—¬`
            ]);
        }
    }
    
    const avgSeriesProgress = Math.round(totalSeriesProgress / seriesLectures.length);
    const seriesProgressBar = "â–“".repeat(Math.floor(avgSeriesProgress/10)) + "â–‘".repeat(10-Math.floor(avgSeriesProgress/10));
    
    dv.paragraph(`**ì‹œë¦¬ì¦ˆ ì „ì²´ ì§„í–‰ë¥ : ${avgSeriesProgress}%**`);
    dv.paragraph(`**ì‹œë¦¬ì¦ˆ ì§„í–‰ë°”**: ${seriesProgressBar}`);
    dv.paragraph(`<progress value="${avgSeriesProgress}" max="100" style="width: 100%; height: 30px; background: linear-gradient(90deg, #f59e0b, #fbbf24);"></progress>`);
    
    dv.table(
        ["ê°•ì˜ëª…", "ê°œë³„ ì§„í–‰ë¥ ", "ìƒíƒœ", "ì‹œë¦¬ì¦ˆ ê¸°ì—¬ë„"],
        lectureProgress
    );
} else {
    dv.paragraph("ì‹œë¦¬ì¦ˆì— ë‹¤ë¥¸ ê°•ì˜ê°€ ì—†ìŠµë‹ˆë‹¤.");
}
```

---

## ğŸ“ ì „ì²´ ì •ë¦¬
### ğŸ¯ í•µì‹¬ ìš”ì•½
```
{{ê°•ì˜ ì „ì²´ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•˜ì„¸ìš”}}
```
### ğŸ’¡ ìƒˆë¡œ ë°°ìš´ ë‚´ìš©
```
{{ì´ë²ˆ ê°•ì˜ì—ì„œ ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ë‚´ìš©}}
```
### â“ ì§ˆë¬¸/ì˜ë¬¸ì 
```
{{í•™ìŠµ ì¤‘ ìƒê¸´ ì§ˆë¬¸ì´ë‚˜ ì˜ë¬¸ì ì„ ê¸°ë¡í•˜ì„¸ìš”}}
```
### ğŸ”„ ë³µìŠµ í•„ìš” ì‚¬í•­
```
{{ë‹¤ì‹œ ë³µìŠµì´ í•„ìš”í•œ ë¶€ë¶„ì´ë‚˜ ì–´ë ¤ì› ë˜ ë‚´ìš©ì„ ê¸°ë¡í•˜ì„¸ìš”}}
```

---

## ğŸ“ˆ í•™ìŠµ í˜„í™©
### â±ï¸ ì‹œê°„ ê¸°ë¡
- **ì‹œì‘ ì‹œê°„**: `$= this["study-start-time"] || "ë¯¸ê¸°ë¡"`
- **ì™„ë£Œ ì‹œê°„**: `$= this["study-end-time"] || "ë¯¸ê¸°ë¡"`
- **ì‹¤ì œ ì†Œìš” ì‹œê°„**: `$= this["actual-time"] || "ë¯¸ê¸°ë¡"`
- **ì§‘ì¤‘ë„**: `$= (this.concentration || "ë¯¸í‰ê°€") + " (5ì  ë§Œì )"`

### ğŸ¯ ì „ì²´ í‰ê°€
- **ë‚´ìš© ë‚œì´ë„**: `$= (this.difficulty ? "â­".repeat(this.difficulty) + " " + this.difficulty : "ë¯¸í‰ê°€") + "/5"`
- **ê°•ì˜ ë§Œì¡±ë„**: `$= (this.satisfaction ? "â­".repeat(this.satisfaction) + " " + this.satisfaction : "ë¯¸í‰ê°€") + "/5"`
- **ì „ì²´ ì´í•´ë„**: `$= (this.understanding ? "â­".repeat(this.understanding) + " " + this.understanding : "ë¯¸í‰ê°€") + "/5"`
- **ì¶”ì²œ ì—¬ë¶€**: `$= this.recommend || "ë¯¸í‰ê°€"`

---

## ğŸ·ï¸ ë©”íƒ€ë°ì´í„°
- **ìƒì„±ì¼**: `$= this.created`
- **ì‹œë¦¬ì¦ˆ**: `$= this["lecture-series"] + " - " + this["course-number"] + "/" + this["total-courses"]`
- **ìƒíƒœ**: `$= this.status`
- **ì™„ë£Œ ì„ê³„ì **: `$= this["completion-threshold"] + "%"`
- **ìë™ ì™„ë£Œ**: `$= this["auto-complete-enabled"] ? "í™œì„±í™”" : "ë¹„í™œì„±í™”"`
